{% load static %}
<html>
    <head>
        <title>Raspberry Pi I/O</title>
        <link rel="stylesheet" href="{% static 'css/stylesheet.css' %}">
        <link rel="shortcut icon" href="{% static 'css/favicon.png' %}" type="image/x-icon" />
    </head>
    <body>
      <div class="header">

      </div>
      <div id='app'>

      <a class="user">User: {{request.user.username}}</a>
      <h1 class="header">Raspberry Pi I/O Controller</h1>
      <a class="ipadd">IP: {{IPX}}</a>
      <a id='logout' href="{% url 'logout' %}"><button class='btn'>Logout</button></a>

        {# ---These here call stuff in main.js----------------------------------------------------------------------------------- #}
<!-- ----------------------------------------------------------------------------------------------- -->
        	<div class="leftcol">
            <div class="radio">
              <div v-for="pin in pins" v-bind:key='pin.name'>
                <div class='grid' id='io_select'>
                    <a class='name'>GPIO ${pin.name}</a>
                    <a class='set'>
                    <input type="radio" v-bind:name="'GPIO'+pin.name" value='0' v-model="pin.func" v-on:change="setPin(pin.name, pin.func)">
                    <label for="in">In</label>
                    <input type="radio" v-bind:name="'GPIO'+pin.name" value='1' v-model="pin.func" v-on:change="setPin(pin.name, pin.func)">
                    <label for="out">Out</label></a>
                    <a class='iosetb' v-if="pin.func==2">ALT 5
                    <a class='ioset' v-if="pin.func==4">ALT 0</a>
                    {# This is column 3 stuff #}
                    <a class='pud' v-if="pin.func==0"> {# 0 = Input #}
                        <input type="radio" v-bind:name="'PUD'+pin.name" value='up' v-model="pin.pud" v-on:change="gpup(pin.name, pin.pud)">
                        <label for="up">Up</label>
                        <input type="radio" v-bind:name="'PUD'+pin.name" value='down' v-model="pin.pud" v-on:change="gpdn(pin.name, pin.pud)">
                        <label for="down">Dn</label>
                        <input type="radio" v-bind:name="'PUD'+pin.name" value='off' v-model="pin.pud" v-on:change="gpoff(pin.name, pin.pud)">
                        <label for="off">Off</label></a>


                    <template>
                        <a class='col3 center' v-if="pin.func==1">GPIO OUT</a>
                        <a v-show="pin.name==7 && pin.func==4" class='col3 center col3spi'>SPI0 CS1</a>
                        <a v-show="pin.name==8 && pin.func==4" class='col3 center col3spi'>SPI0 CS0</a>
                        <a v-show="pin.name==9 && pin.func==4" class='col3 center col3spi'>SPI0 MISO</a>
                        <a v-show="pin.name==10 && pin.func==4" class='col3 center col3spi'>SPI0 MOSI</a>
                        <a v-show="pin.name==11 && pin.func==4" class='col3 center col3spi'>SPI0 SCLK</a>
                        <a v-show="pin.name==16 && pin.func==4" class='col3 center col3spi'>SPI1 CS0</a>
                        <a v-show="pin.name==19 && pin.func==4" class='col3 center col3spi'>SPI1 MISO</a>
                        <a v-show="pin.name==20 && pin.func==4" class='col3 center col3spi'>SPI1 MOSI</a>
                        <a v-show="pin.name==21 && pin.func==4" class='col3 center col3spi'>SPI1 SCLK</a>
                        <a v-show="pin.name==14 && pin.func==4" class='col3 center col3serial'>SERIAL0 TX</a>
                        <a v-show="pin.name==15 && pin.func==4" class='col3 center col3serial'>SERIAL0 RX</a>
                        <a v-show="pin.name==2 && pin.func==4" class='col3 center col3i2c'>I2C1 SDA</a>
                        <a v-show="pin.name==3 && pin.func==4" class='col3 center col3i2c'>I2C1 SCL</a>
                        <a v-show="pin.name==12 && pin.func==4" class='col3 center col3pwm'>PWM0</a>
                        <a v-show="pin.name==13 && pin.func==4" class='col3 center col3pwm'>PWM1</a>
                        <a v-show="pin.name==18 && pin.func==2"class='col3 center col3pwm'>PWM0</a>
                        <a v-show="pin.name==19 && pin.func==2"class='col3 center col3pwm'>PWM1</a>
                    </template>


                    {# This is column 4 stuff #}
                  	<template>
                         <a v-show="pin.func==0 && pin.in_lvl==1" class='linh center'>***HIGH***</a>
                         <a v-show="pin.func==0 && pin.in_lvl==0" class='linl center'>---LOW---</a>
                    </template>

                  	<a class='lout' v-if="pin.func==1"> {# 0 = Output #}
                         <label>OUT:</label>
                  		   <input type="radio" v-bind:name="'OUT'+pin.name" value='1' v-model="pin.in_lvl" v-on:change="gphigh(pin.name, pin.high)">
                  		   <label for="Hi">Hi</label>
                  		   <input type="radio" v-bind:name="'OUT'+pin.name" value='0' v-model="pin.in_lvl" v-on:change="gplow(pin.name, pin.low)">
                  		   <label for="Lo">Lo</label>
                  		   <!-- <input type="radio" v-bind:name="'TEST'+pin.name" value='true' v-model="pin.test" v-on:change="gptest(pin.name)">
                  		   <label for="Test">Flash</label> -->
                    </a>

                    <template>
                        <!-- computed properties -->
                         <a v-show="pin.name==18 && pin.func==2 && pin.in_lvl==1" class='linh center'>***HIGH***</a>
                         <a v-show="pin.name==18 && pin.func==2 && pin.in_lvl==0" class='linl center'>---LOW---</a>
                         <a v-show="pin.name==19 && pin.func==2 && pin.in_lvl==1" class='linh center'>***HIGH***</a>
                         <a v-show="pin.name==19 && pin.func==2 && pin.in_lvl==0" class='linl center'>---LOW---</a>
                         <a v-show="pin.name==12 && pin.func==4 && pin.in_lvl==1" class='linh center'>***HIGH***</a>
                         <a v-show="pin.name==12 && pin.func==4 && pin.in_lvl==0" class='linl center'>---LOW---</a>
                         <a v-show="pin.name==13 && pin.func==4 && pin.in_lvl==1" class='linh center'>***HIGH***</a>
                         <a v-show="pin.name==13 && pin.func==4 && pin.in_lvl==0" class='linl center'>---LOW---</a>
                    </template>

                    <template>
                         <a v-show="pin.name==7 && pin.func==4" class='lina center' >-- Bus 0, CS1 --</a> {# 4 = ALT0 #}
                         <a v-show="pin.name==8 && pin.func==4" class='lina center' >-- Bus 0, CS0 --</a>
                         <a v-show="pin.name==9 && pin.func==4" class='lina center' >-- Bus 0, MISO --</a>
                         <a v-show="pin.name==10 && pin.func==4" class='lina center' >-- Bus 0, MOSI --</a>
                         <a v-show="pin.name==11 && pin.func==4" class='lina center' >-- Bus 0, SCLK --</a>
                         <a v-show="pin.name==16 && pin.func==4" class='lina center' >-- Bus 1, CS0 --</a>
                         <a v-show="pin.name==19 && pin.func==4" class='lina center' >-- Bus 1, MISO --</a>
                         <a v-show="pin.name==20 && pin.func==4" class='lina center' >-- Bus 1, MOSI --</a>
                         <a v-show="pin.name==21 && pin.func==4" class='lina center' >-- Bus 1, SCLK --</a>
                         <a v-show="pin.name==14 && pin.func==4" class='lina center' >-- J3 Pin 2 --</a>
                         <a v-show="pin.name==15 && pin.func==4" class='lina center' >-- J3 Pin 3 --</a>
                         <a v-show="pin.name==2 && pin.func==4" class='lina center' >-- J1 Pin 2 --</a>
                         <a v-show="pin.name==3 && pin.func==4" class='lina center' >-- J1 Pin 3 --</a>

                    </template>
                </div>
              </div>
            </div>
        	</div>
<!-- ----------------------------------------------------------------------------------------------- -->
  	   	  <div class="grid" id='centercol'>
            <div class="ccleft">
              <div class='script' v-for="script in scripts.slice(0, 20)" v-bind:key='script.name'>
                <div class='grid' id='script_select'>
                  <button class='scriptbtn' v-bind:name="script.name" value='script.name' v-on:click="runscript(script.num)">${script.name}</button>
                  <a class='notrunning' v-if="script.running==false">-OFF-</a>
                  <a class='running' v-if="script.running==true">-ON-</a>
                </div>
              </div>
            </div>
            <div class="ccright">
              <div class='script' v-for="script in scripts.slice(20, 40)" v-bind:key='script.name'>
                <div class='grid' id='script_selectb'>
                  <button class='scriptbtnb' v-bind:name="script.name" value='script.name' v-on:click="runscript(script.num)">${script.name}</button>
                  <a class='notrunningb' v-if="script.running==false">-OFF-</a>
                  <a class='runningb' v-if="script.running==true">-ON-</a>
                </div>
              </div>
            </div>
          </div>
<!-- ----------------------------------------------------------------------------------------------- -->
          <b v-show="scripts[19].running">  {# 19 = 20: More Options is ON #}
<!-- ----------------------------------------------------------------------------------------------- -->
            <!-- <c v-show="scripts[6].running">  {# 6 = 7: Software PWM is ON #} -->
              <div class="optcol">
                <div class="radio">
                  <div v-for="pin in pins" v-bind:key='pin.name'>
                    <div class='grid' id='pwm_select'>
                      <template v-if="pin.func==1">
                        <a class="pwmname">GPIO ${pin.name}</a>
                        <b class="pwmfreq">Frequency:
                          <input type="number" name="'GPIO' + pin.name" v-model="pin.frq" min="10" max="8000" v-on:input="gpsfrq(pin.name, sfrq)">
                        </b>
                        <b class="pwmduty">Duty Cycle:
                          <input type="number" name="'GPIO' + pin.name" v-model="pin.dc" min="0" max="255" v-on:input="gpsdc(pin.name, sdc)">
                        </b>
                      </template>
                      <template v-if="pin.func==2 && pin.name==18">
                        <a class="pwmname">PWM 0</a>
                        <b class="pwmfreq">Frequency:
                          <input type="number" name="'GPIO' + pin.name" v-model="pin.frq" min="0" max="30000000" v-on:input="gpshfrq(pin.name, shfrq)">
                        </b>
                        <b class="pwmduty">Duty Cycle:
                          <input type="number" name="'GPIO' + pin.name" v-model="pin.dc" min="0" max="1000000" v-on:input="gpshdc(pin.name, shdc)">
                        </b>
                      </template>
                      <template v-if="pin.func==2 && pin.name==19">
                        <a class="pwmname">PWM 1</a>
                        <b class="pwmfreq">Frequency:
                          <input type="number" name="'GPIO' + pin.name" v-model="pin.frq" min="0" max="30000000" v-on:input="gpshfrq(pin.name, shfrq)">
                        </b>
                        <b class="pwmduty">Duty Cycle:
                          <input type="number" name="'GPIO' + pin.name" v-model="pin.dc" min="0" max="1000000" v-on:input="gpshdc(pin.name, shdc)">
                        </b>
                      </template>
                      <template v-if="pin.func==4 && pin.name==12">
                        <a class="pwmname">PWM 0</a>
                        <b class="pwmfreq">Frequency:
                          <input type="number" name="'GPIO' + pin.name" v-model="pin.frq" min="0" max="30000000" v-on:input="gpshfrq(pin.name, shfrq)">
                        </b>
                        <b class="pwmduty">Duty Cycle:
                          <input type="number" name="'GPIO' + pin.name" v-model="pin.dc" min="0" max="1000000" v-on:input="gpshdc(pin.name, shdc)">
                        </b>
                      </template>
                      <template v-if="pin.func==4 && pin.name==13">
                        <a class="pwmname">PWM 1</a>
                        <b class="pwmfreq">Frequency:
                          <!-- <input type="number" v-bind:name="Freq1" v-model="Freq1" value="Freq1" min="0" max="30000000"> -->
                          <input type="number" name="'GPIO' + pin.name" v-model="pin.frq" min="0" max="30000000" v-on:input="gpshfrq(pin.name, shfrq)">
                        </b>
                        <b class="pwmduty">Duty Cycle:
                          <!-- <input type="number" v-bind:name="Duty1" v-model="Duty1" value="Duty1" min="0" max="1000000"> -->
                          <input type="number" name="'GPIO' + pin.name" v-model="pin.dc" min="0" max="1000000" v-on:input="gpshdc(pin.name, shdc)">
                        </b>
                      </template>
                    </div>
                  </div>
                </div>
              </div>
            <!-- </c>  {# END OF 7: Software PWM is ON #} -->
<!-- ----------------------------------------------------------------------------------------------- -->
          </b>  {# END OF 20: More Options is ON #}
<!-- ----------------------------------------------------------------------------------------------- -->
          <a v-show="!scripts[19].running">  {# 19 = 20:More Options IS OFF #}
            <div class="rightcol">
              <template v-if='"{{request.user.username}}"=="bill"'>
                <iframe class="pyterm" src="{{IP}}"></iframe>
    	        </template>
              <template v-if='"{{request.user.username}}"=="pi"'>
                <iframe class="pyterm" src="{{IPB}}"></iframe>
    	        </template>
              <template v-if='"{{request.user.username}}"!="bill" && "{{request.user.username}}"!="pi"'>
                <img class="img" src="/static/css/rp2_pinout_full.png" alt="RaspPi IO Port" />
    	        </template>
            </div>
          </a>
<!-- ----------------------------------------------------------------------------------------------- -->
        </div>
      <script src="static/vue.js"></script>
      <script src="static/js.cookie.min.js"></script>
      <script src="static/main.js"></script>
    </body>
</html>
